阿刺罕は行軍途中で病気にかかった。范文虎らの軍議は意見がまちまちで、決断することができなかった。七月、蒙古の軍船が残らず日本の島に到着し、そこから五龍山へ移った。九州の武士たちが待ち受けて合戦をしようとしたところ、八月一日に大風が吹いて蒙古の船がことごとく破損した。范文虎らの諸大将は良い船に乗り移って行方も知れず逃げ去り、軍勢は五龍山の麓に漂着したが、兵糧がなくて飲食することができず三日に及んだ。皆で相談し、張百戸という者を指揮官として船を修理しようとしたところ、同月七日に日本の兵たちが押し寄せて攻撃したため、蒙古軍は戦いに敗れて討たれる者が多かった。討ち残された三万人については、日本の兵たちがこれを生け捕りにして八角島ですべて斬り殺した。その中には干閶・莫青・呉といった者たちも含まれていた。